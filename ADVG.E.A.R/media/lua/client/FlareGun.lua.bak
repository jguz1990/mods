--FlareGun = function(owner, weapon, hitObject, damage)
--	print(weapon:getType())
	-- if weapon:getType() ~= "FlareGun" then
	 -- return false
	-- end
	
	-- if owner:getLastHitCount() > 0 then
		-- hitObject:explode()
		-- hitObject:startMuzzleFlash()
	-- elseif owner:isOutside() == false then
		-- owner:explode()
		-- owner:startMuzzleFlash()
	-- else
		-- testHelicopter()
		-- local clim = getWorld():getClimateManager();
        -- if clim then
            -- clim:launchFlare()
        -- end
	-- end

--end

FlareTest = function(wielder, victim, weapon, damage)
	ModInfo = wielder:getModData()
	--FlareShot = ModInfo.FlareShot
	print("TESTIE!")
	print(weapon:getType())
	print(tostring(ModInfo.FlareShot))
	local hitObject = victim
	local owner = wielder
	if weapon:getType() ~= "FlareGun" then
	 return false
	end
	
	if owner:getLastHitCount() > 0 and ModInfo.GroundShot == false then
		--hitObject:getCurrentSquare():explode()
		hitObject:SetOnFire()
		hitObject:startMuzzleFlash()
		ModInfo.FlareShot = false
	elseif owner:isOutside() == false then
		owner:getCurrentSquare():explode()
		owner:startMuzzleFlash()
	else
		testHelicopter()
		local clim = getWorld():getClimateManager();
        if clim then
            clim:launchFlare()
        end
		--launchFlare(1, 1, 1, 1, 1, 1)
	end
	ModInfo.GroundShot = false
end

--Events.OnWeaponHitXp.Add(FlareGun);
Events.OnWeaponHitCharacter.Add(FlareTest)


function GoFlare()
	WorldFlares.new(nil):launchFlare(1, 1, 1, 1, 1, 1)
end
